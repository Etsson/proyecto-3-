<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Simulador de Procesos</title>
  <link rel="stylesheet" href="/static/stylee.css">
</head>
<body>
  <h1>Simulador de Planificaci√≥n de Procesos</h1>

  <!-- üîπ Secci√≥n para agregar procesos -->
  <div class="form">
    <input id="name" placeholder="Nombre del proceso">
    <input id="arrival" type="number" placeholder="Instante de llegada">
    <input id="burst" type="number" placeholder="Tiempo de CPU">
    <button onclick="addProcess()">Agregar Proceso</button>
  </div>

  <!-- üîπ Secci√≥n para elegir algoritmo -->
  <div class="algorithms">
    <select id="algorithm">
      <option value="FCFS">FCFS</option>
      <option value="SJF">SJF</option>
      <option value="RR">Round Robin</option>
    </select>
    <input id="quantum" type="number" placeholder="Quantum (solo RR)">
    <button onclick="run()">Ejecutar</button>
    <button onclick="cancelSimulation()" class="btn-cancel">Cancelar</button>
  <button onclick="clearTable()" class="btn-clear">Limpiar Tabla</button>
 <button onclick="resetAll()" class="btn-reset">Reiniciar</button>
  </div>


  <!-- üîπ Tabla de procesos agregados -->
  <h2>Procesos Ingresados</h2>
  <table id="table">
    <tr><th>Nombre</th><th>Llegada</th><th>CPU</th></tr>
  </table>

  <!-- üîπ √Årea de simulaci√≥n -->
  <h2>Simulaci√≥n</h2>
  <div id="simulation"></div>

<!-- üîπ Tabla de ejecuci√≥n -->
<h3>Resultados de Ejecuci√≥n</h3>
<table id="tablaResultados" border="1">
  <tr><th>Proceso</th><th>Inicio</th><th>Fin</th></tr>
</table>

<!-- üîπ Historial de Cola -->
<h3>Cola de procesos (tiempo real)</h3>
<table id="tablaCola" border="1">
  <tr><th>Tiempo</th><th>Ejecutando</th><th>Cola</th></tr>
</table>


  <script src="/static/script.js">
    function renderGantt(execution) {
    const gantt = document.getElementById('ganttContainer');
    const times = document.getElementById('timesContainer');
    gantt.innerHTML = '';
    times.innerHTML = '';

    if (!execution || execution.length === 0) {
        gantt.innerHTML = '<p>No hay datos de ejecuci√≥n</p>';
        return;
    }

    // Calcular tiempo m√°ximo total
    const maxTime = Math.max(...execution.map(e => e.finish));
    const processNames = [...new Set(execution.map(e => e.name))];

    // üîπ Crear encabezado de tiempos
    let table = '<table style="border-collapse: collapse; width: 100%; text-align: center;">';
    table += '<tr><th style="background:#eee;">Tiempo</th>';
    for (let t = 0; t <= maxTime; t++) {
        table += `<th style="border: 1px solid #ccc; background: #f9f9f9; padding:4px;">${t}</th>`;
    }
    table += '</tr>';

    // üîπ Crear filas por proceso
    processNames.forEach(pName => {
        table += `<tr><th style="background:#eee;">${pName}</th>`;
        for (let t = 0; t < maxTime; t++) {
            const isRunning = execution.some(e => e.name === pName && e.start <= t && e.finish > t);
            const cellStyle = isRunning
                ? `background:${colorFor(pName)}; color:white;`
                : 'background:#f1f1f1;';
            table += `<td style="border:1px solid #999; ${cellStyle}">${isRunning ? '‚ùå' : ''}</td>`;
        }
        table += '</tr>';
    });

    table += '</table>';
    gantt.innerHTML = table;

    // üîπ Tabla de tiempos de espera y retorno
    let timeTable = '<h3>‚è≥ Tiempos por Proceso</h3>';
    timeTable += '<table style="border-collapse: collapse; width: 60%; text-align: center;">';
    timeTable += '<tr><th style="background:#007BFF; color:white;">Proceso</th><th style="background:#007BFF; color:white;">Espera</th><th style="background:#007BFF; color:white;">Retorno</th></tr>';

    processNames.forEach(pName => {
        const pExecs = execution.filter(e => e.name === pName);
        const waiting = pExecs[0].waiting ?? '-';
        const turnaround = pExecs[0].turnaround ?? '-';
        timeTable += `<tr>
            <td style="border:1px solid #ccc; padding:5px;">${pName}</td>
            <td style="border:1px solid #ccc; padding:5px;">${waiting}</td>
            <td style="border:1px solid #ccc; padding:5px;">${turnaround}</td>
        </tr>`;
    });

    timeTable += '</table>';
    times.innerHTML = timeTable;
}

function colorFor(name) {
    const colors = {
        P1: '#007bff',
        P2: '#28a745',
        P3: '#ffc107',
        P4: '#dc3545',
        P5: '#6f42c1',
        P6: '#20c997'
    };
    return colors[name] || '#17a2b8';
}
  </script>

  
</body>
</html>
